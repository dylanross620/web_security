# NOTE: All of the labs' payloads, unless otherwise stated, are values to be used in the `stockApi` parameter of a stock check request

# Normal
1. This lab has a stock checking feature that works by sending a link via a POST request in the `stockApi` parameter. By modifying this URL, we can perform a SSRF attack and send requests on the loopback interface. For example, the following value with delete the `carlos` user `http%3A%2F%2F127.0.0.1/admin/delete?username=carlos`
2. This lab has an admin interface hosted on a back-end server that is not publicly accessible. It is known to be on port `8080` for a server with the IP of `192.168.0.X`. Through bruteforce, it was trivial to determine that the interface is hosted at `192.168.0.5:8080/admin`. To solve the lab, the same stock checking feature from before can be used, with the payload this time being `http://192.168.0.5:8080/admin/delete?username=carlos`
3. This lab has the same features as the first, but blocks requests going to `localhost`/`127.0.0.1` and also blocks the string `admin` in the URL. The first of these can be bypassed using a variety of methods, and the one I chose is using `127.1` instead. The second can be bypassed by double URL encoding part of the string `admin`, such as the `a`. As such, the payload to solve the lab is `http://127.1/%2561dmin/delete?username=carlos`
4. This lab uses a whitelist to validate the external URL that is being passed, and that it is the `stock.weliketoshop.net` domain. It does allow sending usernames such as `name@stock.welike...`, but does not allow the username to contain a `#` in an attempt to put the valid domain in a URL fragment. However, double URL encoding the `#` character leads to an internal server error, which hints that this passes the validation but does correctly send a request to an arbitrary server. As such, the following payload can solve the lab `http://127.0.0.1:80%2523@stock.weliketoshop.net/admin/delete?username=carlos`
5. This lab correctly validates the provided URLs in the stock checking feature point to the local application, but there is an open redirection with the `path` parameter of the `/product/nextProduct` endpoint. This can be used to provide a valid URL that points to the local application, but redirects to the admin page. As such, the following payload solves the lab: `/product/nextProduct?currentProductId=2%26path=http://192.168.0.12:8080/admin/delete?username=carlos`

# Blind
1. This lab uses the `Referer` header on product pages to contact tracking servers. By modifying this header using a MITM, it is possible to perform a SSRF attack
2. This lab is configured to not allow outbound requests that aren't to Burp Collaborator servers. As such, exfiltrating the necessary data is not possible without using Burp Professional
