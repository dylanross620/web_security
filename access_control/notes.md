# Vertical Privilege Escalation
1. By navigating to the lab's `robots.txt` file, you can discover the existence of the `/administrator-panel` page. This page has no authentication, so navigating to it works as is
2. This lab has the same admin panel as before, but it isn't in `robots.txt` and is in an unpredictable location. By viewing the page source, you can see that there is a script that dynamically adds a link to it if the user is an admin. The source code of this script reveals the endpoint, which in my case was `/admin-29sn3o`
3. This lab's admin panel checks the value of the `Admin` cookie to see if the user is an administrator. However, this is forgeable and simply changing the cookie value to `true` is enough to pass the check
4. This lab requires you to be signed in as a user with a `roleid` value of `2` in order to access the admin panel. When changing your email address, you can append the key `roleid` with the value `2` to the POST request and it will update your account's value
5. This lab uses a front-end system to block external access to the admin panel page. However, the back-end server supports the `X-Original-URL` header, which can be used to bypass the front end check. By sending a request to `/` with the header `X-Original-URL: /admin`, we can retrieve the admin panel page and recover how to delete the `carlos` user. In order to do so, you must send a request to `/?username=carlos` with the header `X-Original-URL: /admin/delete`
6. This lab has an account upgrade mechanism that is tolerant of multiple HTTP methods. By exploring the admin panel, we can see that the way to upgrade a user's account is by submitting a `POST` request to `/admin-roles` with the body `username=<name>&action=upgrade`. Non-admin users are blocked from making this request, but the block doesn't catch GET requests. As such, the upgrade can be done by navigating to `/admin-roles?username=wiener&action=upgrade`

# Horizontal Privilege Escalation
1. This lab's my account page has the `id` paramter equal to the user's name. As such, you can access `carlos`'s page by going to `/my-account?id=carlos`
2. This lab has the same setup as before, but uses a GUID instead of the user's name. However, `carlos`'s GUID can be recovered by observing the link his name goes to on posts that he has written. By taking this GUID and putting it into the `/my-account` parameter, his account page can be accessed
3. This lab has the same vulnerability as the first lab in this section, but redirects users to the login page when they attempt to access a different user's page. However, the redirection response contains all of their account info anyway, so the same attack works

# Other
1. This lab has the same vulnerability as the first horizontal escalation lab. In addition, the `/my-account` page shows the user's password in a masked text field. By going to `/my-account?id=administrator`, you can recover the admin's password and use this to sign into their account
2. This lab has a live chat feature, where you can download the current chat's transcript. By clicking the button to download the transcript, you can see that the current chat is retrieved by sending a GET request to `/download-transcript/2.txt`. By sending a request to `/download-transcript/1.txt`, you can retrieve a chat log where `carlos` sends his password
3. This lab has a multi-step process to upgrade a user's account due to asking for user confirmation. The access control can be bypassed by only sending the final, confirmed request. This can be done by sending a POST request to `/admin-roles` with the body `action=upgrade&confirmed=true&username=wiener`
4. This lab has a user upgrade functionality that checks the `Referrer` header to see if the user is authorized. This can be bypassed by manually modifying that header. As such, you can upgrade your own account by navigating to `/admin-roles?username=wiener&action=upgrade` and manually adding the header `Referrer: <lab address>/admin`
